function init(){txtPal=document.getElementById("txtPalabra"),lstPal=document.getElementById("lstPalabras"),txtPal.addEventListener("keypress",enter)}function enter(t){13==t.keyCode&&addWord()}function addWord(){txtPal.value.length>0?(lstWord.push(txtPal.value.replace(" ","").toUpperCase()),cargaLista(txtPal.value.replace(" ","").toUpperCase()),txtPal.value=""):alert("Ingrese una palabra.")}function cargaLista(t){var e=document.createElement("option");e.innerHTML=t,lstPal.appendChild(e)}function getPalabras(){return lstWord}function isNumberKey(t){var e=t.which?t.which:event.keyCode;return 46!=e&&e>31&&(48>e||e>57)?!1:!0}function showText(t){document.getElementById("txtOutput").innerHTML=sopator.toString()}var sopator=function(){function t(){b=document.getElementById("nSize").value,g=document.getElementById("lienzo"),M=b*S+20,m=b*S+20,g.setAttribute("width",M),g.setAttribute("height",m+110),v=g.getContext("2d"),y=getPalabras().slice(0),k=[],y.length>0?(e(),a(),o(),l(),i()):alert("Debe ingresar por lo menos una palabra")}function e(){for(var t=0;m>t;t++){I[t]=[];for(var e=0;M>e;e++)I[t][e]="*"}}function a(){for(var t=0;t<y.length;t++){var e=parseInt(Math.floor(Math.random()*b)),a=parseInt(Math.floor(Math.random()*b)),o=parseInt(Math.floor(8*Math.random()));n(y[t],e,a,P[o])?(k.push([e,a,P[o]]),r(y[t],e,a,P[o])):t--}}function n(t,e,a,n){var r=t.length,o=!1;if(e+r*n[0]>0&&e+r*n[0]<b&&a+r*n[1]>0&&a+r*n[1]<b)for(var l=0;r>l;l++){if("*"!=I[e+l*n[0]][a+l*n[1]]&&I[e+l*n[0]][a+l*n[1]]!=t.charAt(l)){o=!1;break}o=!0}else o=!1;return o}function r(t,e,a,n){for(var r=0;r<t.length;r++)I[e+r*n[0]][a+r*n[1]]=t.charAt(r)}function o(){v.beginPath(),v.fillStyle="#FFF",v.fillRect(0,0,M,m+110),v.closePath(),v.fill(),v.beginPath(),v.strokeStyle="#000",v.strokeRect(0,0,M,m+110),v.closePath(),v.fill()}function l(){for(var t=T.length,e=0;b>e;e++){x[e]=[];for(var a=0;b>a;a++){var n;n="*"==I[e][a]?T.charAt(parseInt(Math.floor(Math.random()*t))):I[e][a],x[e][a]=n,v.beginPath(),v.font="13pt Tahoma",v.fillStyle="#000",v.fillText(n,15+e*S,30+a*S),v.closePath(),v.fill()}}}function i(){v.beginPath(),v.fillRect(10,m-5,M-20,10),v.closePath();for(var t=0,e=0,a=1;a<=y.length;a++)v.beginPath(),v.font="10pt Tahoma",v.fillText(y[a-1],10+150*t,m+20*e+S),v.closePath(),v.fill(),e++,a%5===0&&(t++,e=0)}function s(){for(var t=0;t<k.length;t++){var e=c(k[t][2]);f(v,11+k[t][0]*S+p[e][0]*S,15+k[t][1]*S+p[e][1]*S,y[t].length*S*k[t][2][0],y[t].length*S*k[t][2][1],18,k[t][2][0],k[t][2][1])}}function h(){o(),I=x.slice(),l(),i()}function c(t){for(var e=0,a=0;a<P.length;a++)if(P[a][0]===t[0]&&P[a][1]===t[1]){e=a;break}return e}function f(t,e,a,n,r,o,l,i){var s;Math.abs(l)+Math.abs(i)==2?(s=Math.PI/4,n*=.92,r*=.92):1==Math.abs(l)?s=Math.PI/2:1==Math.abs(i)&&(s=0),t.beginPath(),t.strokeStyle="rgba(255, 0, 0, 0.5)",t.fillStyle="rgba(255, 255, 0, 0.25)",t.moveTo(e,a),t.lineTo(e+n,a+r),t.lineTo(e+n-(0===l?1:l)*o*Math.cos(s),a+r+(0===i?1:i)*o*Math.sin(s)),t.lineTo(e-(0===l?1:l)*o*Math.cos(s),a+(0===i?1:i)*o*Math.sin(s)),t.closePath(),t.fill(),t.stroke()}function u(){var t=document.getElementById("lienzo");window.open(t.toDataURL(),"Pupiletras","left=0,top=0,width="+M+",height="+m+",toolbar=0,resizable=0")}function d(){for(var t="",e=0;b>e;e++){for(var a=0;b>a;a++)t+=x[a][e]+" ";t+="\n"}t+="\nPalabras:\n";for(var n=0;n<y.length;n++)t+=y[n]+"\n";return t+="\n\nSi haz generado tu sopa de letras con este aplicativo, no olvides recomendarlo a tus amigos y mencionarnos. Gracias"}var g,v,P=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],p=[[0,0],[.3,1],[.75,1],[.35,.9],[1,0],[.4,-.2],[.75,0],[.35,-.2]],b=25,m=520,M=520,y=[],I=[],x=[],T="ABCDEFGHIJKLMNÃ‘OPQRSTUVWXYZ",S=24,k=[];return{generate:t,solve2:s,save:u,clean:h,toString:d,palabras:y}}(),lstWord=[],txtPal,lstPal;