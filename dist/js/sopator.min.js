function init(){txtPal=document.getElementById("txtPalabra"),lstPal=document.getElementById("lstPalabras"),txtPal.addEventListener("keypress",enter)}function enter(t){13==t.keyCode&&addWord()}function addWord(){txtPal.value.length>0?(lstWord.push(txtPal.value.replace(" ","").toUpperCase()),cargaLista(txtPal.value.replace(" ","").toUpperCase()),txtPal.value=""):alert("Ingrese una palabra.")}function cargaLista(t){var e=document.createElement("option");e.innerHTML=t,lstPal.appendChild(e)}function getPalabras(){return lstWord}function isNumberKey(t){var e=t.which?t.which:event.keyCode;return 46!=e&&e>31&&(48>e||e>57)?!1:!0}function showText(t){document.getElementById("txtOutput").innerHTML=sopator.toString()}var sopator=function(){function t(){p=document.getElementById("nSize").value,d=document.getElementById("lienzo"),m=p*T+20,b=p*T+20,d.setAttribute("width",m),d.setAttribute("height",b+110),g=d.getContext("2d"),M=getPalabras().slice(0),S=[],M.length>0?(e(),a(),o(),l(),i()):alert("Debe ingresar por lo menos una palabra")}function e(){for(var t=0;b>t;t++){y[t]=[];for(var e=0;m>e;e++)y[t][e]="*"}}function a(){for(var t=0;t<M.length;t++){var e=parseInt(Math.floor(Math.random()*p)),a=parseInt(Math.floor(Math.random()*p)),o=parseInt(Math.floor(8*Math.random()));n(M[t],e,a,v[o])?(S.push([e,a,v[o]]),r(M[t],e,a,v[o])):t--}}function n(t,e,a,n){var r=t.length,o=!1;if(e+r*n[0]>0&&e+r*n[0]<p&&a+r*n[1]>0&&a+r*n[1]<p)for(var l=0;r>l;l++){if("*"!=y[e+l*n[0]][a+l*n[1]]&&y[e+l*n[0]][a+l*n[1]]!=t.charAt(l)){o=!1;break}o=!0}else o=!1;return o}function r(t,e,a,n){for(var r=0;r<t.length;r++)y[e+r*n[0]][a+r*n[1]]=t.charAt(r)}function o(){g.beginPath(),g.fillStyle="#FFF",g.fillRect(0,0,m,b+110),g.closePath(),g.fill(),g.beginPath(),g.strokeStyle="#000",g.strokeRect(0,0,m,b+110),g.closePath(),g.fill()}function l(){for(var t=x.length,e=0;p>e;e++){I[e]=[];for(var a=0;p>a;a++){var n;n="*"==y[e][a]?x.charAt(parseInt(Math.floor(Math.random()*t))):y[e][a],I[e][a]=n,g.beginPath(),g.font="13pt Tahoma",g.fillStyle="#000",g.fillText(n,15+e*T,30+a*T),g.closePath(),g.fill()}}}function i(){g.beginPath(),g.fillRect(10,b-5,m-20,10),g.closePath();for(var t=0,e=0,a=1;a<=M.length;a++)g.beginPath(),g.font="10pt Tahoma",g.fillText(M[a-1],10+150*t,b+20*e+T),g.closePath(),g.fill(),e++,a%5===0&&(t++,e=0)}function s(){for(var t=0;t<S.length;t++){var e=h(S[t][2]);f(g,11+S[t][0]*T+P[e][0]*T,15+S[t][1]*T+P[e][1]*T,M[t].length*T*S[t][2][0],M[t].length*T*S[t][2][1],18,S[t][2][0],S[t][2][1])}}function h(t){for(var e=0,a=0;a<v.length;a++)if(v[a][0]===t[0]&&v[a][1]===t[1]){e=a;break}return e}function f(t,e,a,n,r,o,l,i){var s;Math.abs(l)+Math.abs(i)==2?(s=Math.PI/4,n*=.92,r*=.92):1==Math.abs(l)?s=Math.PI/2:1==Math.abs(i)&&(s=0),t.beginPath(),t.strokeStyle="rgba(255, 0, 0, 0.5)",t.fillStyle="rgba(255, 255, 0, 0.25)",t.moveTo(e,a),t.lineTo(e+n,a+r),t.lineTo(e+n-(0===l?1:l)*o*Math.cos(s),a+r+(0===i?1:i)*o*Math.sin(s)),t.lineTo(e-(0===l?1:l)*o*Math.cos(s),a+(0===i?1:i)*o*Math.sin(s)),t.closePath(),t.fill(),t.stroke()}function c(){var t=document.getElementById("lienzo");window.open(t.toDataURL(),"Pupiletras","left=0,top=0,width="+m+",height="+b+",toolbar=0,resizable=0")}function u(){for(var t="",e=0;p>e;e++){for(var a=0;p>a;a++)t+=I[a][e]+" ";t+="\n"}t+="\nPalabras:\n";for(var n=0;n<M.length;n++)t+=M[n]+"\n";return t+="\n\nSi haz generado tu sopa de letras con este aplicativo, no olvides recomendarlo a tus amigos y mencionarnos. Gracias"}var d,g,v=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],P=[[0,0],[.3,1],[.75,1],[.35,.9],[1,0],[.4,-.2],[.75,0],[.35,-.2]],p=25,b=520,m=520,M=[],y=[],I=[],x="ABCDEFGHIJKLMNÃ‘OPQRSTUVWXYZ",T=24,S=[];return{generate:t,solve2:s,save:c,toString:u,palabras:M}}(),lstWord=[],txtPal,lstPal;