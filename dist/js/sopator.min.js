function init(){txtPal=document.getElementById("txtPalabra"),lstPal=document.getElementById("lstPalabras"),txtPal.addEventListener("keypress",enter)}function enter(t){13==t.keyCode&&addWord()}function addWord(){txtPal.value.length>0?(lstWord.push(txtPal.value.replace(" ","").toUpperCase()),cargaLista(txtPal.value.replace(" ","").toUpperCase()),txtPal.value=""):alert("Ingrese una palabra.")}function cargaLista(t){var e=document.createElement("option");e.innerHTML=t,lstPal.appendChild(e)}function getPalabras(){return lstWord}function isNumberKey(t){var e=t.which?t.which:event.keyCode;return 46!=e&&e>31&&(48>e||e>57)?!1:!0}function showText(t){document.getElementById("txtOutput").innerHTML=sopator.toString()}var sopator=function(){function t(){p=document.getElementById("nSize").value,d=document.getElementById("lienzo"),m=p*T+20,b=p*T+20,d.setAttribute("width",m),d.setAttribute("height",b+110),g=d.getContext("2d"),M=getPalabras().slice(0),k=[],M.length>0?(e(),a(),r(),l(),i()):alert("Debe ingresar por lo menos una palabra")}function e(){for(var t=0;b>t;t++){y[t]=[];for(var e=0;m>e;e++)y[t][e]="*"}}function a(){for(var t=0;t<M.length;t++){var e=parseInt(Math.floor(Math.random()*p)),a=parseInt(Math.floor(Math.random()*p)),r=parseInt(Math.floor(8*Math.random()));n(M[t],e,a,v[r])?(k.push([e,a,v[r]]),o(M[t],e,a,v[r])):t--}}function n(t,e,a,n){var o=t.length,r=!1;if(e+o*n[0]>0&&e+o*n[0]<p&&a+o*n[1]>0&&a+o*n[1]<p)for(var l=0;o>l;l++){if("*"!=y[e+l*n[0]][a+l*n[1]]&&y[e+l*n[0]][a+l*n[1]]!=t.charAt(l)){r=!1;break}r=!0}else r=!1;return r}function o(t,e,a,n){for(var o=0;o<t.length;o++)y[e+o*n[0]][a+o*n[1]]=t.charAt(o)}function r(){g.beginPath(),g.fillStyle="#FFF",g.fillRect(0,0,m,b+110),g.closePath(),g.fill(),g.beginPath(),g.strokeStyle="#000",g.strokeRect(0,0,m,b+110),g.closePath(),g.fill()}function l(){for(var t=x.length,e=0;p>e;e++){I[e]=[];for(var a=0;p>a;a++){var n;n="*"==y[e][a]?x.charAt(parseInt(Math.floor(Math.random()*t))):y[e][a],I[e][a]=n,g.beginPath(),g.font="13pt Tahoma",g.fillStyle="#000",g.fillText(n,15+e*T,30+a*T),g.closePath(),g.fill()}}}function i(){g.beginPath(),g.fillRect(10,b-5,m-20,10),g.closePath();for(var t=0,e=0,a=1;a<=M.length;a++)g.beginPath(),g.font="11pt Tahoma",g.fillText(M[a-1],10+150*t,b+20*e+T),g.closePath(),g.fill(),e++,a%5===0&&(t++,e=0)}function s(){for(var t=0;t<k.length;t++){var e=h(k[t][2]);console.log(e),c(g,11+k[t][0]*T+P[e][0]*T,15+k[t][1]*T+P[e][1]*T,M[t].length*T*k[t][2][0],M[t].length*T*k[t][2][1],18,k[t][2][0],k[t][2][1])}}function h(t){var e=0;console.log(t[0]+" - "+t[1]);for(var a=0;a<v.length;a++)v[a][0]===t[0]&&v[a][1]===t[1]&&(e=a);return e}function c(t,e,a,n,o,r,l,i){var s;Math.abs(l)+Math.abs(i)==2?(s=Math.PI/4,n*=.92,o*=.92):1==Math.abs(l)?s=Math.PI/2:1==Math.abs(i)&&(s=0),t.beginPath(),t.strokeStyle="#b72727",t.moveTo(e,a),t.lineTo(e+n,a+o),t.lineTo(e+n-(0===l?1:l)*r*Math.cos(s),a+o+(0===i?1:i)*r*Math.sin(s)),t.lineTo(e-(0===l?1:l)*r*Math.cos(s),a+(0===i?1:i)*r*Math.sin(s)),t.closePath(),t.stroke()}function f(){var t=document.getElementById("lienzo");window.open(t.toDataURL(),"Pupiletras","left=0,top=0,width="+m+",height="+b+",toolbar=0,resizable=0")}function u(){for(var t="",e=0;p>e;e++){for(var a=0;p>a;a++)t+=I[a][e]+" ";t+="\n"}t+="\nPalabras:\n";for(var n=0;n<M.length;n++)t+=M[n]+"\n";return t+="\n\nSi haz generado tu sopa de letras con este aplicativo, no olvides recomendarlo a tus amigos y mencionarnos. Gracias"}var d,g,v=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]],P=[[0,0],[.3,1],[.75,1],[.35,.9],[1,0],[.4,-.2],[.75,0],[.35,-.2]],p=25,b=520,m=520,M=[],y=[],I=[],x="ABCDEFGHIJKLMNÃ‘OPQRSTUVWXYZ",T=24,k=[];return{generate:t,solve2:s,save:f,toString:u,listaBk:k,palabras:M}}(),lstWord=[],txtPal,lstPal;